<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <title th:text="'Invoice ' + ${invoice.invoiceNumber}">Invoice</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <style type="text/css">
    @page { size: A4; margin: 24mm 18mm; }
    * { box-sizing: border-box; }
    body {
      font-family: Arial, "Helvetica Neue", Helvetica, sans-serif;
      color: #0f172a;
      line-height: 1.35;
      font-size: 12px;
    }
    h1, h2, h3 { margin: 0; }
    .muted { color: #475569; }
    .small { font-size: 11px; }
    .mb-1 { margin-bottom: 4px; }
    .mb-2 { margin-bottom: 8px; }
    .mb-3 { margin-bottom: 12px; }
    .mb-4 { margin-bottom: 16px; }
    .mb-6 { margin-bottom: 24px; }
    .pt-2 { padding-top: 8px; }
    .pt-3 { padding-top: 12px; }
    .pt-4 { padding-top: 16px; }
    .rounded { border-radius: 8px; }
    .chip {
      background: #eef2ff; color: #3730a3;
      padding: 4px 8px; border-radius: 6px; font-weight: 600;
      display: inline-block;
    }

    .right { text-align: right; }
    .left { text-align: left; }
    .hr { height: 1px; background: #e5e7eb; margin: 16px 0; }

    .brand { width: 100%; }
    .brand .title { font-size: 22px; font-weight: 700; letter-spacing: 0.2px; }

    .brand-table { width: 100%; border-collapse: collapse; }
    .brand-table td { vertical-align: top; padding: 0; }
    .meta .label { color: #64748b; }
    .meta .value { font-weight: 600; }

    .panel {
      border: 1px solid #e5e7eb; padding: 12px 14px; border-radius: 10px;
      background: #ffffff;
    }

    .cols { width: 100%; border-collapse: separate; border-spacing: 16px 0; }
    .cols td { vertical-align: top; width: 50%; }

    /* ---------- Items table ---------- */
    table.items {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
    }
    table.items thead th {
      font-weight: 600; font-size: 11px; color: #334155;
      border-bottom: 1px solid #e5e7eb; padding: 8px 6px;
    }
    table.items tbody td {
      padding: 8px 6px; border-bottom: 1px solid #f1f5f9; vertical-align: top;
    }
    /* Description cell: wrap words, but don't push numeric columns */
    .desc {
      overflow-wrap: anywhere;
      word-break: break-word;
    }
    /* Numeric columns: right aligned, fixed-width glyphs, no wrap */
    .num, thead .num {
      text-align: right;
      white-space: nowrap;
      font-family: "Courier New", Courier, monospace; /* guarantees equal-width digits */
    }
    /* If your renderer supports OpenType features, this improves Arial as fallback */
    .num { font-variant-numeric: tabular-nums; font-feature-settings: "tnum" 1, "lnum" 1; }

    /* --------- Totals --------- */
    .totals { width: 100%; }
    .totals-inner { width: 40%; margin-left: 60%; }
    .totals-inner table { width: 100%; border-collapse: collapse; }
    .totals-inner td { padding: 4px 0 4px 16px; }
    .totals .label { color: #334155; }
    .totals .amount { font-weight: 600; text-align: right; }

    tr, img, p, h2, h3 { page-break-inside: avoid; }
  </style>
</head>
<body>

  <div class="brand mb-6">
    <table class="brand-table">
      <tr>
        <td class="left">
          <div class="title">INVOICE</div>
          <div class="muted small">Generated by Invoice Generator</div>
        </td>
        <td class="right meta">
          <div class="label small">Invoice No.</div>
          <div class="value mb-2" th:text="${invoice.invoiceNumber}">2025-000001</div>
          <div class="label small">Invoice Date</div>
          <div class="value" th:text="${#temporals.format(invoice.invoiceDate, 'yyyy-MM-dd')}">2025-10-24</div>
        </td>
      </tr>
    </table>
  </div>

  <table class="cols mb-4">
    <tr>
      <td>
        <div class="panel">
          <h3 class="mb-2">Bill To</h3>
          <div th:text="${invoice.billCompanyName}">Acme GmbH</div>
          <div>
            <span th:text="${invoice.billLine1}">Street 1</span><br />
            <span th:text="${invoice.billLine2}">Line 2</span>
          </div>
          <div>
            <span th:text="${invoice.billPostalCode}">10115</span>
            <span th:text="${invoice.billCity}">Berlin</span>
            (<span th:text="${invoice.billCountryCode}">DE</span>)
          </div>
          <div th:text="${invoice.billPhoneNumber}">+49 â€¦</div>
        </div>
      </td>
      <td>
        <div class="panel">
          <h3 class="mb-2">Details</h3>
          <div>
            <span class="muted">Service Date:</span>
            <span class="chip" th:text="${#temporals.format(invoice.serviceDate, 'yyyy-MM-dd')}">2025-10-24</span>
          </div>
          <div class="pt-2">
            <span class="muted">Reference:</span>
            <span class="chip" th:text="${invoice.id}">#17</span>
          </div>
          <div class="pt-2">
            <span class="muted">Notes:</span>
            <div th:text="${invoice.entryText}">Thank you for your business.</div>
          </div>
        </div>
      </td>
    </tr>
  </table>

  <div class="mb-4">
    <table class="items">


      <thead>
        <tr>
          <th>Pos</th>
          <th>Description</th>
          <th class="num">Qty</th>
          <th class="num">Unit (net)</th>
          <th class="num">Line Total</th>
        </tr>
      </thead>
      <tbody>
        <tr th:each="it : ${invoice.items}">
          <td th:text="${it.position}">1</td>
          <td class="desc">
            <div th:text="${it.description}">Consulting hours</div>
          </td>
          <td class="num" th:text="${it.quantity}">2.000</td>
          <td class="num"
              th:text="${#numbers.formatDecimal(it.unitNetAmount, 1, 'COMMA', 2, 'POINT')}">100.00</td>
          <td class="num"
              th:text="${it.quantity != null and it.unitNetAmount != null ?
                       #numbers.formatDecimal(it.quantity * it.unitNetAmount, 1, 'COMMA', 2, 'POINT') : '0.00'}">
            200.00
          </td>
        </tr>
        <tr th:if="${#lists.isEmpty(invoice.items)}">
          <td colspan="5" class="muted">No line items.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="totals mb-6">
    <div class="totals-inner">
      <table>
        <tr>
          <td class="label">Total (net):</td>
          <td class="amount"
              th:text="${#numbers.formatDecimal(invoice.totalNet, 1, 'COMMA', 2, 'POINT')}">0.00</td>
        </tr>
      </table>
    </div>
  </div>

  <div class="hr"></div>
  <div class="muted small">
    Payment is due within 14 days to the account specified. Please include the invoice number
    in the payment reference. If you have any questions, contact billing@example.com.
  </div>

</body>
</html>
